name: Public Release

on:
  push:
    tags: "*.*.*"
    paths-ignore:
      - "setup.py"
      - "*.yml"
      - "*.md"
      - "skyflow/utils/_version.py"

jobs:
  build-and-deploy:
    uses: ./shared-build-and-deploy.yml@${{ github.head_ref || github.ref_name }}
    with:
      ref: main
      pypi-token: ${{ secrets.PYPI_PUBLISH_TOKEN }}
      is-internal: false
